<section class="flex overflow-hidden" x-data>
  <div class="w-[73%] relative">
        <a class="absolute left-5 top-5 w-6 h-6 z-10 cursor-pointer" @click="window.location = '/home'">
          <svg class="w-full h-full text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
          </svg>
        </a>


        {{ if .PreviousVideo }}
        <!-- Button to previous video -->
        <a class="absolute right-5 top-5 w-6 h-6 z-10 cursor-pointer" 
        @click="window.location = '/watch/{{ .PreviousVideo.Username }}/{{ .PreviousVideo.Key }}/{{ sub .RankNumber 1 }}'"
        >
        <svg class="w-full h-full text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 14">
            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13V1m0 0L1 5m4-4 4 4"/>
          </svg>
        </a>
        {{ end }}

        
        {{ if .NextVideo }}
        <!-- Button to next video -->
        <a class="absolute right-5 bottom-5 w-6 h-6 z-10 cursor-pointer"
        @click="window.location = '/watch/{{ .NextVideo.Username }}/{{ .NextVideo.Key }}/{{ add .RankNumber 1 }}'"
        >
          <svg class="w-full h-full text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 14">
            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 1v12m0 0 4-4m-4 4L1 9"/>
          </svg>
        </a>
        {{ end }}

        
        <div class="flex h-full items-center justify-center justify-items-center z-0">
          <video-js 
          id=vid1 
          class="vjs-default-skin" 
          loop="true"
          preload="auto"
          poster="{{ .Thumbnail }}"
          controls
          ></video-js>
          <!-- "core" version of Video.js -->
          <script>

            if (player) {
              player.dispose()
            }

            // Global request callback defining beforeSend function, will affect every player.
            var player = videojs('vid1', {autoplay: 'play'});
            player.src({
              src: 'http://{{ .API_GATEWAY_URL }}/api/users/{{ .Username }}/videos/{{ .VideoKey }}',
              type: 'application/x-mpegURL',
            });

            /**
             * add manifest authorization header
             */
            window.xhook.before((request, callback) => {
              // only set header request for the videojs src url (don't touch other xhr requests)
              if (request.url === 'http://{{ .API_GATEWAY_URL }}/api/users/{{ .Username }}/videos/{{ .VideoKey }}') {
                request.xhr.setRequestHeader('X-Custom-Header', document.cookie);
              }
              callback();
            });
          </script>
        </div>
  </div>

  <!-- Side bar -->
  <div class="w-[27%] h-screen bg-surface-0">
    <div class="mx-4 my-4 flex flex-col">
      <p class="text-lg text-text-base">{{ .VideoName }}</p>
      <p class="text-sm text-text-base">By {{ .Username }}</p> 
      <p class="text-sm text-text-base">{{ .Video.Views }} views</p>
    </div>
  </div>
</section>

